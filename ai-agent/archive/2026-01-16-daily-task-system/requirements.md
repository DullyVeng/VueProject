# 每日任务系统 - 需求文档

**版本**：1.0  
**更新时间**：2026-01-15

---

## 🎯 需求背景

### 当前问题
- 玩家完成主线任务后缺乏明确目标
- 游戏缺少每日登录/游玩的动力
- 新增的30-90级地图需要引导玩家探索

### 解决方案
通过每日任务系统，给玩家：
1. 每日明确的游玩目标
2. 稳定的资源产出渠道
3. 引导探索各种玩法的机会

---

## 📋 功能需求

### FR-01: 任务生成
**描述**：系统每日自动从任务池中抽取任务  
**验收标准**：
- 每日生成固定数量（4个）任务
- 任务根据玩家等级筛选
- 同一天不重复抽取相同任务

### FR-02: 任务类型
**描述**：支持多种任务类型  
**验收标准**：
- 支持击杀怪物任务
- 支持完成战斗任务
- 支持法宝强化任务
- 支持法宝温养任务
- 支持收集材料任务

### FR-03: 进度追踪
**描述**：实时追踪任务完成进度  
**验收标准**：
- 击杀怪物后自动更新进度
- 完成/结束战斗后自动更新进度
- 强化/温养法宝后自动更新进度
- 获得物品后自动更新进度

### FR-04: 任务刷新
**描述**：每日0点自动刷新任务  
**验收标准**：
- 0点后首次打开自动生成新任务
- 未完成/未领取任务清空
- 保留已领取奖励记录

### FR-05: 奖励领取
**描述**：完成任务后领取奖励  
**验收标准**：
- 单个任务完成后可领取对应奖励
- 领取后标记为已完成
- 全部完成后可领取额外奖励

### FR-06: UI界面
**描述**：可视化任务面板  
**验收标准**：
- 显示今日所有任务
- 显示每个任务进度
- 显示奖励内容
- 显示刷新倒计时
- 可折叠/展开

---

## 📊 任务池设计

### 低等级任务（1-15级）
| 任务名 | 类型 | 目标 | 奖励 |
|--------|------|------|------|
| 日常历练 | 击杀 | 任意×5 | 100 EXP, 50 灵石 |
| 初出茅庐 | 战斗 | 胜利×3 | 80 EXP, 30 灵石 |
| 采药学徒 | 收集 | 灵草×5 | 60 EXP, 40 灵石 |
| 法宝入门 | 强化 | ×2 | 50 EXP, 60 灵石 |

### 中等级任务（16-40级）
| 任务名 | 类型 | 目标 | 奖励 |
|--------|------|------|------|
| 妖兽猎人 | 击杀 | 任意×10 | 200 EXP, 100 灵石 |
| 战场老兵 | 战斗 | 胜利×5 | 150 EXP, 80 灵石 |
| 材料收集 | 收集 | 任意×10 | 120 EXP, 100 灵石 |
| 法宝精进 | 强化 | ×3 | 100 EXP, 120 灵石 |
| 温养之道 | 温养 | ×5 | 100 EXP, 80 灵石 |

### 高等级任务（41-90级）
| 任务名 | 类型 | 目标 | 奖励 |
|--------|------|------|------|
| 修仙日常 | 击杀 | 任意×15 | 350 EXP, 200 灵石 |
| BOSS挑战 | 击杀 | BOSS×1 | 500 EXP, 300 灵石 |
| 百战不殆 | 战斗 | 胜利×8 | 300 EXP, 150 灵石 |
| 法宝大师 | 强化 | ×5 | 200 EXP, 250 灵石 |
| 温养宗师 | 温养 | ×8 | 200 EXP, 150 灵石 |

### 全部完成奖励
- 1-15级：100 EXP + 50 灵石
- 16-40级：200 EXP + 100 灵石
- 41-90级：400 EXP + 200 灵石

---

## 💻 技术需求

### TR-01: 数据持久化
- 使用 Supabase 存储每日任务进度
- 支持断线重连后恢复进度
- 支持多设备同步

### TR-02: 性能要求
- 进度更新延迟 < 500ms
- 面板加载时间 < 1s
- 不影响战斗流畅度

### TR-03: 兼容性
- 与现有任务系统共存
- 复用现有奖励发放机制
- 复用现有UI风格

---

## ❌ 非功能需求

### 暂不实现
- 任务手动刷新（需消耗道具）
- 任务难度选择
- 任务链/连续任务

### 后续考虑
- 周常任务
- 月度挑战
- 限时活动任务

---

## 📅 里程碑

| 阶段 | 内容 | 预计时间 |
|------|------|----------|
| M1 | 基础架构完成 | 2-3小时 |
| M2 | 核心逻辑完成 | 2-3小时 |
| M3 | UI界面完成 | 2小时 |
| M4 | 系统集成完成 | 1小时 |
| M5 | 测试完善完成 | 1小时 |

**总计**：约8-10小时（1个工作日）
